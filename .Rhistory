library(Lahman)
names(Master)
#get Boggs' player ID
Master %>%
filter(nameLast == "Boggs")
library(tidyverse)
#get Boggs' player ID
Master %>%
filter(nameLast == "Boggs")
#get Boggs' player ID
Master %>%
filter(nameLast == "Boggs", nameFirst == "Wade")
boggs = Batting %>%
filter(playerID == "boggswa01")
View(boggs)
#calculate batting average by team
boggs %>%
group_by(teamID) %>%
summarise(BA = H/AB)
#calculate batting average by team
boggs %>%
group_by(teamID) %>%
summarise(H/AB)
#calculate batting average by team
boggs %>%
group_by(teamID) %>%
summarize(BA = H/AB)
#calculate batting average by team
boggs %>%
group_by(teamID) %>%
summarize(BA = sum(H)/sum(AB))
#plot his batting average by season
boggs %>%
ggplot(aes(x = yearID, y = H/AB)) +
geom_point()
#plot his batting average by season
boggs %>%
ggplot(aes(x = yearID, y = H/AB, color = teamID)) +
geom_point()
#plot his batting average by season
boggs %>%
ggplot(aes(x = yearID, y = H/AB, color = teamID)) +
geom_point() +
labs(x = "year",
y = "batting average",
title = "Wade Boggs batting average by year and team")
#plot his batting average by season
boggs %>%
ggplot(aes(x = yearID, y = H/AB, color = teamID)) +
geom_point() +
labs(x = "year",
y = "batting average",
title = "Wade Boggs batting average by year")
Teams
Teams %>%
select(yearID,BB,G)
Teams %>%
filter(yearID > 1919) %>%
select(yearID,BB,G)
Teams %>%
filter(yearID > 1919) %>%
select(yearID,BB,G) %>%
arrange(desc(BB))
Teams %>%
filter(yearID > 1919) %>%
select(yearID,BB,G) %>%
arrange(desc(BB)) %>%
head(10)
Teams %>%
filter(yearID > 1919) %>%
select(yearID,BB,G) %>%
arrange(desc(BB)) %>%
mutate(BBperGame = BB/G) %>%
head(10)
Teams %>%
summarize(walk_rate = sum(BB)/sum(G))
Teams %>%
summarize(walk_rate = sum(BB, na.rm = TRUE)/sum(G))
Teams %>%
filter(yearID > 1919) %>%
select(yearID,BB,G) %>%
arrange(desc(BB)) %>%
mutate(BBperGame = BB/G) %>%
head(10)
Teams %>%
summarize(walk_rate = sum(BB, na.rm = TRUE)/sum(G))
Teams %>%
group_by(yearID)
Teams %>%
group_by(yearID) %>%
summarize(walk_rate = sum(BB, na.rm = TRUE)/sum(G))
#Calculate the walk rate per 9 innings by season
Teams %>%
group_by(yearID) %>%
summarize(walks_per_game = sum(BB)/sum(G),
SO_per_game = sum(SO)/sum(G)) -> walks
walks %>% head(3)
walks = walks %>%
mutate(walks_SO_ratio = walks_per_game/SO_per_game)
walks %>% head(10)
Teams
Teams %>%
select(yearID, BB, G)
Teams %>%
select(yearID, BB, G) %>%
head(10)
Teams %>%
select(yearID, BB, G) %>%
filter(yearID > 1919) %>%
arrange(desc(BB)) %>%
head(10)
Teams %>%
select(yearID, BB, G) %>%
filter(yearID > 1919) %>%
arrange(desc(BB)) %>%
mutate(BB_per_game = BB/G) %>%
head(10)
Teams %>%
summarize(walks_rate = sum(BB)/sum(G))
Teams %>%
summarize(walks_rate = sum(BB, na.rm = TRUE)/sum(G))
Teams %>%
group_by(yearID) %>%
summarize(walks_rate = sum(BB, na.rm = TRUE)/sum(G))
names(Teams)
library(Lahman)
library(tidyverse)
Pitching %>% head(2)
Pitching %>%
group_by(playerID) %>%
summarize(W = sum(W, na.rm = TRUE),
L = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) -> Wins.350
Pitching %>%
group_by(playerID) %>%
summarize(W = sum(W, na.rm = TRUE),
L = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(W > 349) -> Wins.350
Master %>% head(2)
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID")
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst," ", nameLast)) %>%
select(player, W, L, SO, BB)
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst,nameLast)) %>%
select(player, W, L, SO, BB)
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst,nameLast)) %>%
select(player, W, L, SO, BB) -> Wins.350
head(Pitching)
library(tidyverse)
library(Lahman)
head(Pitching)
Pitching %>%
filter(yearID > 1969) %>%
group_by(yearID) %>%
summarize(BFP.game = BFP/G)
Pitching %>%
filter(yearID > 1969) %>%
group_by(yearID) %>%
summarize(BFP.game = sum(BFP)/sum(G))
Pitching %>%
filter(yearID > 1969) %>%
group_by(yearID) %>%
summarize(BFP.game = sum(BFP)/sum(G)) -> BFP
BFP %>%
ggplot(aes(x = yearID, y = BFP.game))
BFP %>%
ggplot(aes(x = yearID, y = BFP.game)) +
geom_point()
Pitching %>%
filter(yearID > 1969) %>%
group_by(playerID) %>%
summarize(BFP = sum(BFP),
G = sum(G),
GS = sum(GS)) -> Pitching.type
head(Pitching.type)
Pitching %>%
filter(yearID > 1969) %>%
group_by(yearID,playerID) %>%
summarize(BFP = sum(BFP),
G = sum(G),
GS = sum(GS)) -> Pitching.type
Pitching.type %>%
mutate(type = ifelse(GS > 9, "Starter", "Reliever")) -> Pitching.type
Pitching.type
hist(Pitching.type$BFP)
Pitching.type %>%
filter(BFP > 100) %>%
group_by(yearID, type) %>%
summarize(BFP.game = sum(BFP)/sum(G)) -> BFP.type
BFP.type
BFP.type %>%
ggplot(aes(x = yearID, y = BFP.game, color = type)) +
geom_point()
Pitching %>%
group_by(playerID) %>%
summarize(W = sum(W, na.rm = TRUE),
L = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(W > 349) -> Wins.350
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst,nameLast)) %>%
select(player, W, L, SO, BB) -> Wins.350
Wins.350
Pitching %>%
group_by(playerID) %>%
summarize(W = sum(W, na.rm = TRUE),
L = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(W > 349) %>%
arrange(desc(W))-> Wins.350
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst,nameLast)) %>%
select(player, W, L, SO, BB) -> Wins.350
Wins.350
Master %>% filter(nameLast == "Henderson")
Pitching %>%
group_by(playerID) %>%
summarize(W = sum(W, na.rm = TRUE),
L = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(W > 349) -> Wins.350
Wins.350
Pitching %>%
group_by(playerID) %>%
summarize(total.Wins = sum(W, na.rm = TRUE),
total.Losses = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(W > 349) -> Wins.350
Pitching %>%
group_by(playerID) %>%
summarize(total.Wins = sum(W, na.rm = TRUE),
total.Losses = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(total.Wins > 349) -> Wins.350
Wins.350
Wins.350
Pitching %>%
group_by(playerID) %>%
summarize(W = sum(W, na.rm = TRUE),
L = sum(L, na.rm = TRUE),
SO = sum(SO, na.rm = TRUE),
BB = sum(BB, na.rm = TRUE)) %>%
filter(W > 349) -> Wins.350
Wins.350
Master %>% select(playerID, nameFirst, nameLast)
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID")
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst,nameLast))
Wins.350 %>%
left_join(Master %>% select(playerID, nameFirst, nameLast),
by = "playerID") %>%
mutate(player = paste(nameFirst,nameLast)) %>%
select(player, W, L, SO, BB)
Teams %>% filter(yearID == 2018)
library(Lahman)
head(Teams)
hofpitching = read_csv(file = "https://raw.githubusercontent.com/maxtoki/baseball_R/master/data/hofpitching.csv")
library(tidyverse)
hofpitching = read_csv(file = "https://raw.githubusercontent.com/maxtoki/baseball_R/master/data/hofpitching.csv")
library(Lahman)
# number of wins by season per team
Teams %>%
ggplot(aes(x = W)) +
geom_boxplot()
# number of wins by season per team
Teams %>%
ggplot(aes(y = W)) +
geom_boxplot()
# number of wins by season per team
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(y = W)) +
geom_boxplot()
# number of wins by season per team
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = lgID, y = W)) +
geom_boxplot()
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W)) +
geom_point()
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W, color = lgID)) +
geom_point()
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W, color = lgID)) +
geom_point() +
geom_smooth(se = "FALSE")
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W, color = lgID)) +
geom_point() +
geom_smooth()
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W, color = lgID)) +
geom_point() +
geom_smooth(method = "lm")
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID,
size = ERA)) +
geom_point() +
```
names(Teams)
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID,
size = ERA)) +
geom_point()
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID)) +
geom_point() +
labs(x = "Home Runs",
y = "Wins",
title "Wins versus Home Runs by league")
# let's look at Homeruns vs Wins
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID)) +
geom_point() +
labs(x = "Home Runs",
y = "Wins",
title = "Wins versus Home Runs by league")
#Answer to fraction of complete games
complete.games = Teams %>%
filter(yearID > 1969) %>%
group_by(yearID) %>%
summarize(CG.frac = sum(CG)/sum(G))
complete.games %>%
ggplot(aes(x = yearID, y = CG.frac)) +
geom_point() +
labs(x = "Year", y = "Fraction complete games",
title = "Fraction of complete games by year")
#Answer to fraction of complete games
complete.games = Teams %>%
filter(yearID > 1969) %>%
group_by(yearID, lgID) %>%
summarize(CG.frac = sum(CG)/sum(G))
complete.games %>%
ggplot(aes(x = yearID, y = CG.frac, color = lgID)) +
geom_point() +
labs(x = "Year", y = "Fraction complete games",
title = "Fraction of complete games by year")
dev.off()
hofpitching <- read_csv(file = "https://raw.githubusercontent.com/maxtoki/baseball_R/master/data/hofpitching.csv")
View(hofpitching)
#Number of wins in a season
Teams %>%
ggplot(aes(x = W)) +
geom_boxplot()
#Number of wins in a season
Teams %>%
ggplot(aes(y = W)) +
geom_boxplot()
#Number of wins in a season (2018)
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(y = W)) +
geom_boxplot()
#Number of wins in a season (2018)
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = lgID, y = W)) +
geom_boxplot()
#Number of wins in a season (2018)
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = lgID, y = W)) +
geom_boxplot() +
labs(x = "league", y = "Wins",
title = "Number of wins by team (2018)")
#Number of wins vs homeruns
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W)) +
geom_point() +
labs(x = "Homeruns", y = "Wins",
title = "Home Run vs Wins (2018)")
#Number of wins vs homeruns
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR, y = W, color = lgID)) +
geom_point() +
labs(x = "Homeruns", y = "Wins",
title = "Home Run vs Wins (2018)")
#Number of wins vs homeruns
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID,
size = ERA)) +
geom_point() +
labs(x = "Homeruns", y = "Wins",
title = "Home Run vs Wins (2018)")
#Number of wins vs homeruns
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID)) +
geom_point() +
labs(x = "Homeruns", y = "Wins",
title = "Home Run vs Wins (2018)")
#Number of wins vs homeruns
Teams %>%
filter(yearID == 2018) %>%
ggplot(aes(x = HR,
y = W,
color = lgID)) +
geom_point() +
labs(x = "Homeruns", y = "Wins",
title = "Home Run vs Wins (2018)") +
geom_smooth(method = "lm")
complete.games = Teams %>%
filter(yearID > 1969) %>%
group_by(yearID) %>%
summarize(CG.frac = sum(CG)/sum(G))
View(complete.games)
complete.games %>%
ggplot(aes(x = yearID, y = CG.frac)) +
geom_point() +
labs(x = "years", y = "complete games(fraction)",
title = "Fraction of complete games (1970-2018)")
complete.games %>%
ggplot(aes(x = yearID, y = CG.frac, color = lgID)) +
geom_point() +
labs(x = "years", y = "complete games(fraction)",
title = "Fraction of complete games (1970-2018)")
complete.games = Teams %>%
filter(yearID > 1969) %>%
group_by(yearID, lgID) %>%
summarize(CG.frac = sum(CG)/sum(G))
complete.games %>%
ggplot(aes(x = yearID, y = CG.frac, color = lgID)) +
geom_point() +
labs(x = "years", y = "complete games(fraction)",
title = "Fraction of complete games (1970-2018)")
library(tidyverse)
houses = read_csv(file = "redfin_2018-11-02-05-18-50.csv")
houses %>%
ggplot(aes(x = `SQUARE FEET`, y = PRICE)) +
geom_point()
houses %>%
filter(PRICE < 600000) %>%
ggplot(aes(x = `SQUARE FEET`, y = PRICE)) +
geom_point()
houses %>%
filter(PRICE < 600000) %>%
ggplot(aes(x = `SQUARE FEET`, y = PRICE)) +
geom_point() + geom_smooth()
houses %>%
filter(PRICE < 600000) %>%
ggplot(aes(x = `SQUARE FEET`, y = PRICE)) +
geom_point() + geom_smooth(method = "lm")
houses %>%
filter(PRICE < 600000, PRICE > 200000) %>%
ggplot(aes(x = `SQUARE FEET`, y = PRICE)) +
geom_point() + geom_smooth(method = "lm")
houses %>%
filter(PRICE < 600000, PRICE > 200000) %>%
ggplot(aes(x = `SQUARE FEET`, y = PRICE,
size = 2019 - `YEAR BUILT`)) +
geom_point() + geom_smooth(method = "lm")
1-pnorm(2,0,1)
